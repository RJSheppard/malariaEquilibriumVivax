<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Return equilibrium solution to malaria transmission model (P. vivax) • malariaEquilibriumVivax</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Return equilibrium solution to malaria transmission model (P. vivax)">
<meta property="og:description" content='Often we are interested in the state of a given malaria
   transmission model at equilibrium. However, some models (e.g. the Griffin et
   al. 2014 model, the White et al. 2018 model) are quite complex, and can result in equilibrium solutions
   that are fairly in-depth. In these situations it is useful to have a
   "canonical" equilibrium solution that is tried and tested, and can be used
   reliably by multiple users. This package complement the malariaEquilibriumVivax 
   package to store canonical equilibrium solutions for Plasmodium vivax malaria models.'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">malariaEquilibriumVivax</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/malariaEquilibriumVivax/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="malariaequilibrium">malariaEquilibrium<a class="anchor" aria-label="anchor" href="#malariaequilibrium"></a>
</h1></div>
<p><a href="https://travis-ci.org/mrc-ide/malariaEquilibrium" class="external-link"><img src="https://travis-ci.org/mrc-ide/malariaEquilibrium.svg?branch=master" alt="Travis build status"></a> <a href="https://ci.appveyor.com/project/mrc-ide/malariaEquilibrium" class="external-link"><img src="https://ci.appveyor.com/api/projects/status/github/mrc-ide/malariaEquilibrium?branch=master&amp;svg=true" alt="AppVeyor build status"></a></p>
<p>Often we are interested in the state of a malaria transmission model at equibrium. However, some models (e.g. the Griffin et al. 2014 model) are quite complex, and can result in equilibrium solutions that are fairly in-depth. In these situations it is useful to have a “canonical” equilibrium solution that is tried and tested, and can be used reliably by multiple users. This package aims to be a place for hosting these canonical solutions, and for storing useful tests, checks and plotting functions for exploring model predictions at equilibrium.</p>
<div class="section level2">
<h2 id="how-to-interact-with-this-repos">How to interact with this repos<a class="anchor" aria-label="anchor" href="#how-to-interact-with-this-repos"></a>
</h2>
<p>If you have a new model with an equilibrium solution that you would like to host here, then please go ahead and do so <em>in a new branch</em>. The master branch, on the other hand, should always correspond to the current most active model used by the malaria group (currently the Griffin et al. 2014 model). This should generally be left alone unless you know what you’re doing.</p>
<p>Any changes that you propose to branches that you did not create yourself (e.g. the master branch) should be done through pull requests, rather than editing directly. This gives others the opportunity to review your changes before they are implemented in code.</p>
<p>NB. These stipulations are in place because there are other R packages that test against the equilibrium solutions from this package, and so any changes here may cause other packages to fail if they are not know about beforehand.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install from the master branch of malariaEquilibrium with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"mrc-ide/malariaEquilibrium"</span><span class="op">)</span></span></code></pre></div>
<p>Or from a specific branch with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"mrc-ide/malariaEquilibrium"</span>, ref <span class="op">=</span> <span class="st">"mybranch"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, don’t forget to load the package with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">malariaEquilibrium</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="section level3">
<h3 id="working-with-parameters">Working with parameters<a class="anchor" aria-label="anchor" href="#working-with-parameters"></a>
</h3>
<p>We start by loading a set of model parameters with the <code><a href="https://rdrr.io/pkg/malariaEquilibrium/man/load_parameter_set.html" class="external-link">load_parameter_set()</a></code> function. This loads an object from the <em>inst/extdata</em> folder of the package. Alternatively you can load your own parameter set from file.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myparams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/malariaEquilibrium/man/load_parameter_set.html" class="external-link">load_parameter_set</a></span><span class="op">(</span><span class="st">"Jamie_parameters.rds"</span><span class="op">)</span></span></code></pre></div>
<p>Parameters are of class <code>model_params</code>, which is essentially just an ordinary R list with a few custom methods. For example, when we print we see the following:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myparams</span></span>
<span><span class="co">#&gt;              value</span></span>
<span><span class="co">#&gt; eta   0.0001304631</span></span>
<span><span class="co">#&gt; rho           0.85</span></span>
<span><span class="co">#&gt; a0            2920</span></span>
<span><span class="co">#&gt; s2            1.67</span></span>
<span><span class="co">#&gt; rA           0.005</span></span>
<span><span class="co">#&gt; rT             0.2</span></span>
<span><span class="co">#&gt; rD             0.2</span></span>
<span><span class="co">#&gt; rU     0.009090909</span></span>
<span><span class="co">#&gt; rP            0.04</span></span>
<span><span class="co">#&gt; dE              12</span></span>
<span><span class="co">#&gt; tl            12.5</span></span>
<span><span class="co">#&gt; cD           0.068</span></span>
<span><span class="co">#&gt; cT         0.02176</span></span>
<span><span class="co">#&gt; cU          0.0062</span></span>
<span><span class="co">#&gt; g_inf         1.82</span></span>
<span><span class="co">#&gt; d1           0.161</span></span>
<span><span class="co">#&gt; dd            3650</span></span>
<span><span class="co">#&gt; ID0           1.58</span></span>
<span><span class="co">#&gt; kd           0.477</span></span>
<span><span class="co">#&gt; ud            9.45</span></span>
<span><span class="co">#&gt; ad0         7993.5</span></span>
<span><span class="co">#&gt; fd0         0.0071</span></span>
<span><span class="co">#&gt; gd            4.81</span></span>
<span><span class="co">#&gt; aA           0.757</span></span>
<span><span class="co">#&gt; aU           0.186</span></span>
<span><span class="co">#&gt; b0            0.59</span></span>
<span><span class="co">#&gt; b1             0.5</span></span>
<span><span class="co">#&gt; db            3650</span></span>
<span><span class="co">#&gt; IB0           43.9</span></span>
<span><span class="co">#&gt; kb            2.16</span></span>
<span><span class="co">#&gt; ub             7.2</span></span>
<span><span class="co">#&gt; phi0         0.792</span></span>
<span><span class="co">#&gt; phi1       0.00074</span></span>
<span><span class="co">#&gt; dc           10950</span></span>
<span><span class="co">#&gt; IC0             18</span></span>
<span><span class="co">#&gt; kc            2.37</span></span>
<span><span class="co">#&gt; uc            6.06</span></span>
<span><span class="co">#&gt; PM           0.774</span></span>
<span><span class="co">#&gt; dm            67.7</span></span>
<span><span class="co">#&gt; tau             10</span></span>
<span><span class="co">#&gt; mu           0.132</span></span>
<span><span class="co">#&gt; f        0.3333333</span></span>
<span><span class="co">#&gt; Q0            0.92</span></span>
<span><span class="co">#&gt; cd_w         0.723</span></span>
<span><span class="co">#&gt; cd_p         0.342</span></span></code></pre></div>
<p>We can modify parameter values exactly as we would with a named list:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myparams</span><span class="op">$</span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">myparams</span><span class="op">)</span></span>
<span><span class="co">#&gt;     value</span></span>
<span><span class="co">#&gt; eta   0.1</span></span>
<span><span class="co">#&gt; rho  0.85</span></span>
<span><span class="co">#&gt; a0   2920</span></span>
<span><span class="co">#&gt; s2   1.67</span></span>
<span><span class="co">#&gt; rA  0.005</span></span>
<span><span class="co">#&gt; rT    0.2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="getting-the-equilibrium-solution">Getting the equilibrium solution<a class="anchor" aria-label="anchor" href="#getting-the-equilibrium-solution"></a>
</h3>
<p>Now we can calculate the equilibrium solution using the <code><a href="https://rdrr.io/pkg/malariaEquilibrium/man/human_equilibrium.html" class="external-link">human_equilibrium()</a></code> function. This assumes a fixed EIR and treatment rate (<code>ft</code>), and takes model parameters as input. It calculates the equilibrium solution for a defined age range:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/malariaEquilibrium/man/human_equilibrium.html" class="external-link">human_equilibrium</a></span><span class="op">(</span>EIR <span class="op">=</span> <span class="fl">10</span>, ft <span class="op">=</span> <span class="fl">0.2</span>, p <span class="op">=</span> <span class="va">myparams</span>, age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>The output elements are “states” and “FOIM”. The former is a matrix with age brackets in rows, and model states or other downstream calculations in columns. For example, the column “S” gives the equilibrium proportion of humans in the susceptible state, while the column “pos_M” gives the proportion of hosts positive by microscopy in this bracket.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">eq</span><span class="op">$</span><span class="va">states</span><span class="op">)</span></span>
<span><span class="co">#&gt;      age            S            T            D            A            U</span></span>
<span><span class="co">#&gt; [1,]   0 9.467880e-01 1.563207e-03 6.252830e-03 1.588967e-02 6.493094e-04</span></span>
<span><span class="co">#&gt; [2,]   1 2.438063e-02 7.314807e-05 2.925923e-04 1.026347e-03 5.530062e-05</span></span>
<span><span class="co">#&gt; [3,]   2 6.251534e-04 2.618414e-06 1.047366e-05 4.558052e-05 3.000507e-06</span></span>
<span><span class="co">#&gt; [4,]   3 1.599499e-05 8.441349e-08 3.376539e-07 1.716239e-06 1.320333e-07</span></span>
<span><span class="co">#&gt; [5,]   4 4.089291e-07 2.574924e-09 1.029970e-08 5.887601e-08 5.139869e-09</span></span>
<span><span class="co">#&gt; [6,]   5 1.045661e-08 7.592526e-11 3.037010e-10 1.903552e-09 1.846483e-10</span></span>
<span><span class="co">#&gt;                 P          inf         prop       psi        pos_M      pos_PCR</span></span>
<span><span class="co">#&gt; [1,] 2.190291e-03 1.541308e-03 9.733333e-01 0.2014989 2.368415e-02 2.433854e-02</span></span>
<span><span class="co">#&gt; [2,] 1.275394e-04 9.139654e-05 2.595556e-02 0.2953252 1.390077e-03 1.445847e-03</span></span>
<span><span class="co">#&gt; [3,] 5.321638e-06 3.874773e-06 6.921481e-04 0.3781267 5.856141e-05 6.158762e-05</span></span>
<span><span class="co">#&gt; [4,] 1.919563e-07 1.417641e-07 1.845728e-05 0.4511988 2.133356e-06 2.266525e-06</span></span>
<span><span class="co">#&gt; [5,] 6.374654e-09 4.769418e-09 4.921942e-07 0.5156846 7.155090e-08 7.673621e-08</span></span>
<span><span class="co">#&gt; [6,] 2.007472e-10 1.520110e-10 1.312518e-08 0.5725932 2.275346e-09 2.461764e-09</span></span>
<span><span class="co">#&gt;               inc</span></span>
<span><span class="co">#&gt; [1,] 2.366225e-03</span></span>
<span><span class="co">#&gt; [2,] 8.931033e-05</span></span>
<span><span class="co">#&gt; [3,] 2.961462e-06</span></span>
<span><span class="co">#&gt; [4,] 9.190789e-08</span></span>
<span><span class="co">#&gt; [5,] 2.741310e-09</span></span>
<span><span class="co">#&gt; [6,] 7.965503e-11</span></span></code></pre></div>
<p>The “FOIM” element gives the onward force of infection from humans to mosquitoes, which is a single number:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eq</span><span class="op">$</span><span class="va">FOIM</span></span>
<span><span class="co">#&gt; [1] 0.002690066</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mrc-ide/malariaEquilibriumVivax/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mrc-ide/malariaEquilibriumVivax/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing malariaEquilibriumVivax</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Richard Sheppard <br><small class="roles"> Author, maintainer </small>  </li>
<li>Pete Winskill <br><small class="roles"> Author </small>  </li>
<li>Giovanni Charles <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Richard Sheppard, Pete Winskill, Giovanni Charles.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
